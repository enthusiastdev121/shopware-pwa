import{ref as t,computed as a}from"@vue/composition-api";import n from"axios";const e={endpoint:"https://shopware-2.vuestorefront.io/sales-channel-api/v1",accessToken:"SWSCMUDKAKHSRXPJEHNOSNHYAG",contextToken:"",defaultPaginationLimit:10};let o={};!function(t={}){o=Object.assign(o,e,t)}();const c=function(t){o=Object.assign(o,t)},r=o;const i=n.create({});function s(){i.defaults.baseURL=r.endpoint,i.defaults.headers.common["sw-access-key"]=r.accessToken,r.contextToken?i.defaults.headers.common["sw-context-token"]=r.contextToken:delete i.defaults.headers.common["sw-context-token"]}s(),i.interceptors.response.use((function(t){return function(t={}){c(t),s(),v()}({contextToken:t.headers["sw-context-token"]}),t}),(async function(t){throw t}));const u=t=>`/product/${t}`,l=()=>"/checkout/cart",d=t=>`/checkout/cart/product/${t}`,f=t=>`/checkout/cart/line-item/${t}`,m=()=>"/vsf/page";var E,h;async function p(t,a=null){return(await i.get(u(t),{params:a})).data.data}!function(t){t[t.ONE=1]="ONE",t[t.FIVE=5]="FIVE",t[t.TEN=10]="TEN",t[t.TWENTY_FIVE=25]="TWENTY_FIVE",t[t.FIFTY=50]="FIFTY",t[t.SEVENTY_FIVE=75]="SEVENTY_FIVE",t[t.HUNDRED=100]="HUNDRED",t[t.FIVE_HUNDRED=500]="FIVE_HUNDRED"}(E||(E={})),function(t){t.PRODUCT="product",t.CREDIT="credit",t.CUSTOM="custom",t.PROMOTION="promotion"}(h||(h={}));const T=[];function v(){T.forEach(t=>t({config:r}))}const y=()=>{const a=t(!1),n=t(null),e=t(null);return{page:n,loading:a,search:async t=>{a.value=!0;try{const e=await async function(t,a){return(await i.post(m(),{path:t})).data}(t);return n.value=e,e}catch(t){e.value=t,console.error("Problem with fetching data",t.message)}finally{a.value=!1}},error:e}},w=a=>{const n=t(!1),e=t(a),o=t(null);return{product:e,loading:n,search:async t=>{n.value=!0;try{const a=await p(t);return e.value=a,a}catch(t){o.value=t,console.error("Problem with fetching data",t.message)}finally{n.value=!1}},error:o,loadAssociations:async t=>{if(!e||!e.value||!e.value.id)throw"Associations cannot be loaded for undefined product";const a=await p(e.value.id,t);e.value=a}}},g=()=>{let n=k();const e=t(!1),o=t(null);const c=a(()=>n.getters.getCart),r=a(()=>c.value&&c.value.lineItems||[]),s=a(()=>r.value.reduce((t,a)=>a.quantity+t,0)),u=a(()=>{return c.value&&c.value.price&&c.value.price.totalPrice||0});return{addProduct:async function({id:t,quantity:a}){const e=await async function(t,a){return(await i.post(d(t),{quantity:a})).data.data}(t,a);n.commit("SET_CART",e)},cart:c,cartItems:r,changeProductQuantity:async function({id:t,quantity:a}){const e=await async function(t,a=1){let n={quantity:parseInt(a.toString())};return(await i.patch(f(t),n)).data.data}(t,a);n.commit("SET_CART",e)},count:s,error:o,loading:e,refreshCart:async function(){e.value=!0;try{const t=await async function(){return(await i.get(l())).data.data}();n.commit("SET_CART",t)}catch(t){o.value=t,console.error("Problem with fetching data",t.message)}finally{e.value=!1}},removeProduct:async function({id:t}){const a=await async function(t){return(await i.delete(f(t))).data.data}(t);n.commit("SET_CART",a)},totalPrice:u}};let I;function N(t){I=t}function k(){return I}export{k as getStore,N as setStore,g as useCart,y as useCms,w as useProduct};
